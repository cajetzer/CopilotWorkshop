
name: Assign Issue to Copilot
on:
  issues:
    types: [opened]

permissions:
  issues: write

jobs:
  assign-to-copilot:
    runs-on: ubuntu-latest
    steps:
      - name: Try to assign via GitHub CLI
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          ISSUE_NUMBER: ${{ github.event.issue.number }}
          REPO: ${{ github.repository }}
        run: |
          echo "Attempting to assign issue #${ISSUE_NUMBER} to Copilot..."
          
          # Try using gh CLI to assign to copilot
          # The CLI might have access to features not in the REST API
          if gh issue edit ${ISSUE_NUMBER} --repo ${REPO} --add-assignee "github-copilot[bot]" 2>/dev/null; then
            echo "✅ Successfully assigned issue to Copilot via CLI"
          else
            echo "❌ CLI assignment failed. Trying API workaround..."
            
            # Add a comment that might trigger Copilot assignment
            gh issue comment ${ISSUE_NUMBER} --repo ${REPO} --body "@github-copilot Please handle this issue"
            
            echo "⚠️  Automatic assignment not available via API yet."
            echo "Please manually click the 'Assign to Copilot' button for issue #${ISSUE_NUMBER}"
            echo "Comment added to notify you to assign manually."
          fi
